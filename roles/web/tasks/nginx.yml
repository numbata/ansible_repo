 - name: Nginx | Add the nginx repository
   apt_repository:
     repo: ppa:nginx/stable

 - name: Nginx | Make sure the nginx directory exists
   file:
     path: "{{nginx_dir}}"
     owner: root
     group: root
     mode: 0755
     recurse: yes
     state: directory

 - name: Nginx | Make sure the nginx log directory exists
   file:
     path: "{{nginx_log_dir}}"
     owner: root
     group: root
     mode: 0755
     recurse: yes
     state: directory

 - name: Nginx | Make sure the sites-available, sites-enabled and conf.d directories exist
   file:
     path: "{{nginx_dir}}/{{item}}"
     owner: root
     group: root
     mode: 0755
     recurse: yes
     state: directory
   with_items: ["sites-available", "sites-enabled", "conf.d"]

 - name: Nginx | Make sure nginx is installed (package)
   apt:
     pkg: nginx
     state: present
   notify:
     - restart nginx
